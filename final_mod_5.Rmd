---
title: "final"
author: "Laith Alayassa"
date: "6/28/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r libraries}
library(tidyverse)     # for data cleaning and plotting
library(lubridate)     # for date manipulation
library(ggthemes)      # for more themes (including theme_map())
library(plotly)        # for the ggplotly() - basic interactivity
library(gganimate)     # for adding animation layers to ggplots
library(readr)
library(gt)            # for creating nice tables
theme_set(theme_minimal())
library(readxl)
library(ggbump)
library(patchwork)
library(rvest)    
library(robotstxt)
library(see)
theme_set(theme_minimal())

```

***insert Armenian flag photo***

I have lived in Armenia for the past two years (2018-2020) before coming back here to Palestine, there, I have finished my IB diploma and lived in an international school at times, and finished the two years living with locals. When I first came to Armenia, I did not feel it was very different from my home in Palestine, they were both countries with poor populations, however, there was a noticeable difference in the economic and social situation in Armenia after those two years have passed, and I want to investigate.

In 2019, Armenians around me were laughing at the fact that their country was marked as the angriest in the world in a Gallup survey with %45 of their population expressing feeling a lot of anger in the previous day (McCarthy). This got me thinking about the well-being and the happiness of the population since I imagine that a psychologically distressed population would have a hard time developing its economy.

```{r}
#Source: (“World Happiness Index - Knoema.Com”)
hapiness_index <- read_excel("Armenian_Data/hapiness_index.xlsx") %>% 
  pivot_longer( cols = starts_with("20"), names_to = "year") 
```

```{r}
hapiness_index %>% 
  ggplot(aes(x = year,
             y = value,
             group = 1)) +
  geom_point() +
  geom_line() +
  labs(
    y = "Happiness score"
  )
#Add labs


```

We can see that during the past few years starting from 2017, there has been a sharp increase in the happiness index in the country compared with the prior years. This increase of nearly 1 point in happiness scale took Armenia from being the 128th happiest country to the 86th happiest country in the world in an extraordinarly short time(“World Happiness Index - Knoema.Com”).

These conflicting messages suggest that while Armenians might be the angriest people on the planet -however extraordinary generous- they are making rapid progress in terns if happiness.

I will try to explore the reasons for this increase in happiness and overall well-being of the country that I have witnessed in such a short time and that the data suggests. I will use the word "satisfaction" to indicate the results from the happiness scale and will start analyzing with 2 Hypothesis: Increased satisfaction due to economic growth, increased satisfaction after the 2018 revolution.



```{r}
# import using importWizard
armenia_worldbank_2 <- read_excel("Armenian_Data/armenia_worldbank_2.xlsx", 
    col_types = c("text", "skip", "text", 
        "skip", "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric"), skip = 4)

```

To explore economic growth I will start by looking at GDP (constant 2010 US$):

```{r}
gdp1 <- armenia_worldbank_2 %>% 
  select(-starts_with("19")) %>% 
  filter(`Indicator Name`== "GDP per capita (constant 2010 US$)") %>% 
  pivot_longer(cols = starts_with("2"),
               names_to = "year",
               values_to = "GDP") %>% 
  ggplot(aes(x = year,
             y = GDP,
             group = 1)) +
  geom_line()
```

```{r}
gdp2<- armenia_worldbank_2 %>% 
  filter(`Indicator Name` == "GDP growth (annual %)") %>% 
    pivot_longer(cols = starts_with("2"),
               names_to = "year",
               values_to = "GDP_growth") %>% 
  ggplot(aes(x = year,
             y = GDP_growth,
             group = 1)) +
  geom_col()
``` 

```{r fig.height= 10}
gdp1 / gdp2
```

We see that GDP has been sharply increasing for Armenia until 2009 when it suffered a strong decrease in GDP, however was able to recover and have a high 7.5% increase in GDP in 2018

One element that is greatly contributing to the economy of Armenia is tourism due to its remarkable nature and the fact that most Armenians speak Russian, making it a popular destination for poeple from Caucasis and Russian-speaking nations.

***Insert photo of Nature***

```{r}
#Source: https://knoema.com/atlas/Armenia/Number-of-arrivals

number_of_arrivals <- read_excel("Armenian_Data/number of arrivals.xlsx") %>% 
  mutate(year = as.character (DATE))
```

```{r}
arrivals <- number_of_arrivals %>% 
  filter(DATE == "2019" | DATE == "2008") %>% 
  ggplot(aes(x = DATE,
             y = VALUE,
             group = 1)) +
  geom_col() +
  # geom_line()+
  # geom_point() +
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) +
  labs(y = "Number of tourists") 

arrivals
```


Using the number of arriving tourists as a rough  indicator, we can see that the number of arriving tourists has tripled from around 500,000 in 2009 to 1,900,000 in 2019.

```{r}
paths_allowed(paths ="https://www.worlddata.info/asia/armenia/tourism.php")
```
```{r}
tourist_rev_url <- read_html("https://www.worlddata.info/asia/armenia/tourism.php")
```


```{r}
tourist_year <- 
  tourist_rev_url %>%
  html_nodes(".left") %>%
  html_text()

tourist_income_per_tourist <- 
  tourist_rev_url %>%
  html_nodes("td:nth-child(5)") %>%
  html_text()
```


```{r}
tourist_info <- tibble(year=tourist_year, income_per_tourist =tourist_income_per_tourist) %>% 
  mutate( income_per_tourist= gsub(x = income_per_tourist,'\\$', '', num),
          income_per_tourist = gsub(x = income_per_tourist,'\\,', '', num))
```

```{r}
tourist_spending <- number_of_arrivals %>% 
  left_join(tourist_info) %>% 
  mutate(total_revenue = as.numeric (income_per_tourist) * VALUE,
         `Revenue in Billion` = total_revenue/1000000000)
```


This increase in number of tourists lead to a huge increase in revenues in the tourism sphere in the past years and generated a great number of business opportunities. Armenia is now generating over 1.5 Billion US dollars in revenue compared to a 560 million dollars generated in 2008. 

```{r, dpi= 150}
tourist_spending_plot <- tourist_spending  %>% 
  ggplot(aes(x = year,
             y = `Revenue in Billion`,
             group = 1)) +
  geom_line() +
  geom_point() +
  labs(y = "Tourism revenue in Billion Dollars")

ggplotly(tourist_spending_plot)
```


```{r}
poverty_headcount <- armenia_worldbank_2 %>% 
    select(-starts_with("19")) %>% 
  filter(`Indicator Name`== "Poverty headcount ratio at $3.20 a day (2011 PPP) (% of population)") %>% 
  pivot_longer(cols = starts_with("2"),
               names_to = "year",
               values_to = "poverty") %>% 
  ggplot(aes(x = year,
             y = poverty,
               group = 1)) +
  geom_bump()

poverty_headcount

```



Aside from economic flourishing wish could be contributing to the increase in satisfaction of the citizens, Armenia has been a more domestically peaceful country with intentinoal homicide rates dropping after early 1990's. This is significant to our satisfaction analysis because a kids born in the year 2000 is now 21, and has lived a childhood in a relatively safer enviornemnt, and is now contributing to the studies that measure hapiness, and moreover, the parents of these children might be also more satisfied that their children had a relatively peacful childhood.

```{r}
armenia_worldbank_2 %>%
  select(`Indicator Name`, starts_with("1"), starts_with("2")) %>% 
  filter(`Indicator Name` == "Intentional homicides (per 100,000 people)") %>% 
  pivot_longer(cols = -`Indicator Name`,
               names_to = "year",
               values_to = "homicide_rate") %>%
  filter(homicide_rate > 1) %>% 
  ggplot(aes(x = year,
             y = homicide_rate,
             group = 1)) +
  geom_bump(size = 1)

# ggsave(filename = "attempt10.png", dpi = 600)
#Kids who were born in early 2000 and are now young adults has experienced much less of this
```







<!-- ```{r} -->
<!-- tourist_revenue <- tourist_info %>%  -->
<!--   filter(year > 2000) %>%  -->
<!--   ggplot(aes(x = year , y = revenue4)) + -->
<!--   geom_col() -->

<!-- arrivals/tourist_revenue_graph -->
<!-- ``` -->











```{r}

armenian_populations <- read_csv("Armenian_Data/armenian_pop/world_populations.csv", 
    col_types = cols(`Country Code` = col_skip(), 
        `Indicator Name` = col_skip(), `Indicator Code` = col_skip()), 
    skip = 4) %>% 
  filter(`Country Name`== "Armenia") %>% 
  pivot_longer(cols = -`Country Name`, names_to = "year", values_to = "population")

```









